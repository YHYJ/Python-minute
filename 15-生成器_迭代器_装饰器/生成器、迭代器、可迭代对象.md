### 生成器(generator) & 迭代器(iterator) & 可迭代对象(iterable):

* **生成器**：一种一边循环一边计算的机制，生成器定义的是一种算法

  ###### **工作原理**

  > 总是调用next()方法计算出下一个元素的值，直到满足停止条件，再次调用抛出StopIteration异常

* **生成器函数**：包含 **yield** 关键字的函数

  ```python
  def fibonacci_series(max):
      """生成器函数实现斐波那契数列"""
      n, a, b = 0, 0, 1
      while n < max:
          yield b
          a, b = b, a+b
          n += 1
      return None
  fiber = fibonacci_series(6)		# 创建生成器对象
  ```

  ###### 执行流程：

  > 普通函数顺序执行，遇到return语句或最后一行就结束
  >
  > 生成器函数在每次调用next()方法时执行（for循环本质也是调用next()获取下一个值），遇到**yield**语句返回，再次执行时从上次的yield处继续执行

* **迭代器**：实现了\_\_iter\_\_()和\_\_next\_\_()方法的对象，可以被next()函数调用并返回它的下一个值，表示一个数据流

  > 有序序列
  >
  > 序列长度未知
  >
  > 迭代器的计算是惰性的
  >
  > 可以表示一个无限大的数据流

  ```python
  class Fib:
      """自定义迭代器实现斐波那契数列"""
      def __init__(self, max):
          """
          :param max: 指定生成数列的前max个数
          """
          self.max = max
          self.value = 0  # 记录生成了数列中的第几个数了
          self.x = 0      # 保存向前数第二位数，初始值为数列第一个数0
          self.y = 1      # 保存前一位数，初始值为数列第二个数1

      def __next__(self):
          """
          next()函数调用来获取下一个数
          """
          if self.value < self.max:
              num = self.y
              self.x, self.y = self.y, self.x + self.y
              self.value += 1
              return num
          else:
              raise StopIteration

      def __iter__(self):
          return self

      
  if __name__ == "__main__":
  	fib = Fib(max = 5)
  	for i in fib:
      	print(i)
  ```


  ###### for的迭代器语法糖：

  > 在for循环中，Py自动对in后的可迭代对象调用内建函数iter()获得它的迭代器对象，然后对迭代器调用next()方法获得下一个元素，直到抛出StopIteration异常

  ```python
  for i in [2,4,6,8,]:
      pass
  ## 实际上等价于：
  it = iter([1,2,3,])     # 通过iter()方法获得可迭代数据类型的迭代器对象
  print(it)
  print(next(it))
  print(next(it))
  print(next(it))         # 通过next()方法来访问list中的元素
  # 容器中没有可访问的元素后next()方法抛出一个StopIteration异常终止迭代器
  ```

  ​


* **可迭代对象**：只要具备了\_\_iter\_\_()方法就是可迭代对象，可以直接作用于for循环

  ###### 可迭代对象要求支持**迭代器协议**，即可以实现**iter()**和**next()**方法

  > iter()方法获取可迭代对象的迭代器对象并返回，实际是调用了其\_\_iter__()方法
  >
  > next()方法返回迭代器中的下一个元素，最后会引发StopIteration异常

  1. list、tuple、dict、set、str ——集合数据类型
  2. 生成器(generator)和带有 yiled 的生成器函数

  ```python
  class MyList:
      """自定义可迭代对象，即实现__iter__()"""
      def __init__(self):
          self.container = []
          
      def add(self, item):
          self.container.append(item)
          
      def __iter__(self):
          """返回一个迭代器对象"""
          pass
  ```

  ​

  ​

  #### 关联和区别：

  ###### 关联：

  1. ___生成\* 迭代\*___ 生成器对象和生成器函数即是迭代器也是可迭代对象

     ```python
     from collections import Iterator，Iterable
     print(isinstance(fiber,Iterator))	# True，迭代器对象
     print(isinstance(fiber,Iterable))	# True，可迭代对象
     ```

  2. 可迭代对象是生成迭代器的基础

  3. ___可迭代对象和迭代器对象___：对可迭代对象调用**iter()**函数可以获得它的迭代器对象

     > 实际是调用了可迭代对象的\_\_iter\_\_()方法，所以要在可迭代对象的\_\_iter\_\_()方法中返回一个迭代器

  4. ___生成器和可迭代对象___：可迭代对象包含生成器和生成器函数，还有集合数据类型